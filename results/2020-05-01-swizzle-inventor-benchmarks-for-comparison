./swizzle_inventor_benchmarks/benchmark.sh swizzle_inventor_benchmarks/big_l3_2d-stencil-5.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-5.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-1.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-4.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-2.rkt swizzle_inventor_benchmarks/small_l2_2d-stencil-3.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-4.rkt swizzle_inventor_benchmarks/small_l3_1d-stencil.rkt swizzle_inventor_benchmarks/small_l1_1d-stencil.rkt swizzle_inventor_benchmarks/small_l2_2d-stencil-5.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-7.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-5.rkt swizzle_inventor_benchmarks/small_l1_2d-stencil-5.rkt swizzle_inventor_benchmarks/small_l3_1d-conv.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-1.rkt swizzle_inventor_benchmarks/small_l1_1d-conv.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-3.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-5.rkt swizzle_inventor_benchmarks/small_l2_1d-stencil.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-3.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-2.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-1.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-4.rkt swizzle_inventor_benchmarks/small_l2_1d-conv.rkt swizzle_inventor_benchmarks/small_l3_2d-stencil-3.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-7.rkt swizzle_inventor_benchmarks/small_l1_2d-stencil-3.rkt swizzle_inventor_benchmarks/small_l1_trove-crc-7.rkt swizzle_inventor_benchmarks/small_l3_trove-crc-2.rkt swizzle_inventor_benchmarks/small_l1_trove-rcr-3.rkt
swizzle_inventor_benchmarks/big_l3_2d-stencil-5.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/big/l3/2d-stencil-5 575538
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/big_l3_2d-stencil-5.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 5) (kx 5))
    (let* ((index-j (ite (> warp-row (+ -1 ky)) (@dup 0) (@dup 1)))
           (index-i (ite (< kx (+ 1 warp-col)) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 4 4 1 kx 5 0 1 0))
           (lane-y (sw-xform warp-row H 0 1 4 -1 ky 5 0 1 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
576
swizzle_inventor_benchmarks/small_l3_trove-crc-5.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 5)
(i 0 5)
(i 1 5)
(i 2 5)
(i 3 5)
(i 4 5)
(permute-vector 5)
(i 0 5)
(i 1 5)
(i 2 5)
(i 3 5)
(i 4 5)
run:inventor/benchmarks/small/l3/trove-crc-5 121211
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-5.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 3 5 5 1 localId warpSize 2 32 0))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 5 32 32 1 i struct-size 0 1 0))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 1 5 -1 localId warpSize -1 1 0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
122
swizzle_inventor_benchmarks/small_l1_trove-rcr-1.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 1)
(i 0 1)
run:inventor/benchmarks/small/l1/trove-rcr-1 316
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-rcr-1.rkt:76:0
'(define (AOS-load-rcr-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       -1
       warpSize
       warpSize
       1
       i
       struct-size
       31
       struct-size
       31)))
   (define O-cached
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         0
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         0))))
   (local-to-global
    O-cached
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       31
       warpSize
       warpSize
       1
       i
       struct-size
       31
       struct-size
       31))))
(cost 0)
1
swizzle_inventor_benchmarks/small_l1_trove-crc-4.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 4)
(i 0 4)
(i 1 4)
(i 2 4)
(i 3 4)
(permute-vector 4)
(i 0 4)
(i 1 4)
(i 2 4)
(i 3 4)
run:inventor/benchmarks/small/l1/trove-crc-4 781
swizzle_inventor_benchmarks/small_l1_trove-crc-2.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 2)
(i 0 2)
(i 1 2)
(permute-vector 2)
(i 0 2)
(i 1 2)
run:inventor/benchmarks/small/l1/trove-crc-2 344
swizzle_inventor_benchmarks/small_l2_2d-stencil-3.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/small/l2/2d-stencil-3 46004
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l2_2d-stencil-3.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 3) (kx 3))
    (let* ((index-j (ite (> warp-row (+ -1 ky)) (@dup 0) (@dup 1)))
           (index-i (ite (> warp-col (- 1 kx)) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 W W 1 kx 3 3 3 2))
           (lane-y (sw-xform warp-row H 1 H H 1 ky 3 1 3 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
46
swizzle_inventor_benchmarks/small_l1_trove-rcr-4.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 4)
(i 0 4)
(i 1 4)
(i 2 4)
(i 3 4)
run:inventor/benchmarks/small/l1/trove-rcr-4 6173
swizzle_inventor_benchmarks/small_l3_1d-stencil.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l3/1d-stencil 15867
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_1d-stencil.rkt:89:0
'(define (stencil-1d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list +) /3 blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (> localId (+ -1 (@dup i))) (@dup 0) (@dup 1)))
           (lane (sw-xform localId warpSize 0 1 32 -1 i warpSize 1 4 0))
           (x (shfl (get I-cached index) lane)))
      (accumulate o x #:pred (>= (choose localId) (- -1 (choose localId))))))
   (reg-to-global o O gid))
16
swizzle_inventor_benchmarks/small_l1_1d-stencil.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l1/1d-stencil 6773
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_1d-stencil.rkt:89:0
'(define (stencil-1d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list +) /3 blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (>= localId (@dup i)) (@dup 0) (@dup 1)))
           (lane
            (sw-xform
             localId
             warpSize
             1
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (x (shfl (get I-cached index) lane)))
      (accumulate o x #:pred #t)))
   (reg-to-global o O gid))
7
swizzle_inventor_benchmarks/small_l2_2d-stencil-5.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/small/l2/2d-stencil-5 141540
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l2_2d-stencil-5.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 5) (kx 5))
    (let* ((index-j (ite (> warp-row (+ -1 ky)) (@dup 0) (@dup 1)))
           (index-i (ite (<= kx (+ 0 warp-col)) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 W W 1 kx 5 1 5 0))
           (lane-y (sw-xform warp-row H 1 H H 1 ky 5 1 5 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
141
swizzle_inventor_benchmarks/small_l3_trove-crc-7.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 7)
(i 0 7)
(i 1 7)
(i 2 7)
(i 3 7)
(i 4 7)
(i 5 7)
(i 6 7)
(permute-vector 7)
(i 0 7)
(i 1 7)
(i 2 7)
(i 3 7)
(i 4 7)
(i 5 7)
(i 6 7)
run:inventor/benchmarks/small/l3/trove-crc-7 145043
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-7.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 5 7 7 1 localId warpSize -1 -1 5))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 7 32 32 1 i struct-size 30 1 6))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 -1 7 -1 localId warpSize -1 1 6))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
146
swizzle_inventor_benchmarks/small_l1_trove-crc-5.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 5)
(i 0 5)
(i 1 5)
(i 2 5)
(i 3 5)
(i 4 5)
(permute-vector 5)
(i 0 5)
(i 1 5)
(i 2 5)
(i 3 5)
(i 4 5)
run:inventor/benchmarks/small/l1/trove-crc-5 2173
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-crc-5.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         3
         struct-size
         struct-size
         1
         localId
         warpSize
         2
         warpSize
         0))))
   (for
    ((i struct-size))
    (let* ((lane
            (sw-xform
             localId
             warpSize
             5
             warpSize
             warpSize
             1
             i
             struct-size
             1
             struct-size
             0))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         1
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
2
swizzle_inventor_benchmarks/small_l1_2d-stencil-5.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/small/l1/2d-stencil-5 65897
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_2d-stencil-5.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 5) (kx 5))
    (let* ((index-j (ite (<= ky warp-row) (@dup 0) (@dup 1)))
           (index-i (ite (>= warp-col kx) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 W W 1 kx 5 1 5 0))
           (lane-y (sw-xform warp-row H 1 H H 1 ky 5 1 5 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
66
swizzle_inventor_benchmarks/small_l3_1d-conv.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l3/1d-conv 22930
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_1d-conv.rkt:91:0
'(define (conv1d-sketch threadId blockID blockDim I O W I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list * +) identity blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (> localId (+ -1 (@dup i))) (@dup 0) (@dup 1)))
           (lane (sw-xform localId warpSize 1 32 32 1 i warpSize 0 1 0))
           (w-idx
            (sw-xform
             localId
             warpSize
             0
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (x (shfl (get I-cached index) lane))
           (w (get W w-idx)))
      (accumulate
       o
       (list w x)
       #:pred
       (>= (choose localId) (- -1 (choose localId))))))
   (reg-to-global o O gid))
23
swizzle_inventor_benchmarks/small_l1_trove-crc-1.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 1)
(i 0 1)
(permute-vector 1)
(i 0 1)
run:inventor/benchmarks/small/l1/trove-crc-1 122
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-crc-1.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         0
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         0))))
   (for
    ((i struct-size))
    (let* ((lane
            (sw-xform
             localId
             warpSize
             1
             warpSize
             warpSize
             1
             i
             struct-size
             31
             struct-size
             0))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         0
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
0
swizzle_inventor_benchmarks/small_l1_1d-conv.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l1/1d-conv 9128
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_1d-conv.rkt:91:0
'(define (conv1d-sketch threadId blockID blockDim I O W I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list * +) identity blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (>= localId (@dup i)) (@dup 0) (@dup 1)))
           (lane
            (sw-xform
             localId
             warpSize
             1
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (w-idx
            (sw-xform
             localId
             warpSize
             0
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (x (shfl (get I-cached index) lane))
           (w (get W w-idx)))
      (accumulate o (list w x) #:pred #t)))
   (reg-to-global o O gid))
9
swizzle_inventor_benchmarks/small_l3_trove-crc-3.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 3)
(i 0 3)
(i 1 3)
(i 2 3)
(permute-vector 3)
(i 0 3)
(i 1 3)
(i 2 3)
run:inventor/benchmarks/small/l3/trove-crc-3 17126
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-3.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 1 3 -1 localId warpSize 1 32 1))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 3 32 32 1 i struct-size -1 3 2))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 -1 3 -1 localId warpSize -1 1 2))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
17
swizzle_inventor_benchmarks/small_l1_trove-rcr-5.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 5)
(i 0 5)
(i 1 5)
(i 2 5)
(i 3 5)
(i 4 5)
run:inventor/benchmarks/small/l1/trove-rcr-5 10728
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-rcr-5.rkt:76:0
'(define (AOS-load-rcr-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       1
       warpSize
       warpSize
       1
       i
       struct-size
       0
       struct-size
       0)))
   (define O-cached
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         3
         struct-size
         struct-size
         1
         localId
         warpSize
         2
         warpSize
         0))))
   (local-to-global
    O-cached
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       13
       warpSize
       warpSize
       1
       i
       struct-size
       19
       struct-size
       0))))
(cost 0)
13
swizzle_inventor_benchmarks/small_l2_1d-stencil.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l2/1d-stencil 11645
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l2_1d-stencil.rkt:89:0
'(define (stencil-1d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list +) /3 blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (> localId (+ -1 (@dup i))) (@dup 0) (@dup 1)))
           (lane
            (sw-xform
             localId
             warpSize
             1
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (x (shfl (get I-cached index) lane)))
      (accumulate o x #:pred (= (choose localId) (+ 0 (choose localId))))))
   (reg-to-global o O gid))
12
swizzle_inventor_benchmarks/small_l1_trove-crc-3.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 3)
(i 0 3)
(i 1 3)
(i 2 3)
(permute-vector 3)
(i 0 3)
(i 1 3)
(i 2 3)
run:inventor/benchmarks/small/l1/trove-crc-3 1077
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-crc-3.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         1
         struct-size
         struct-size
         1
         localId
         warpSize
         1
         warpSize
         1))))
   (for
    ((i struct-size))
    (let* ((lane
            (sw-xform
             localId
             warpSize
             3
             warpSize
             warpSize
             1
             i
             struct-size
             31
             struct-size
             2))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         -1
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         2))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
2
swizzle_inventor_benchmarks/small_l1_trove-rcr-2.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 2)
(i 0 2)
(i 1 2)
run:inventor/benchmarks/small/l1/trove-rcr-2 1955
swizzle_inventor_benchmarks/small_l3_trove-crc-1.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 1)
(i 0 1)
(permute-vector 1)
(i 0 1)
run:inventor/benchmarks/small/l3/trove-crc-1 3961
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-1.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform i struct-size 0 1 1 (choose 1 -1) localId warpSize 0 16 0))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 1 32 32 -1 i struct-size 30 -1 16))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i)
        (sw-xform i struct-size 0 1 1 (choose 1 -1) localId warpSize 0 -1 0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
5
swizzle_inventor_benchmarks/small_l3_trove-crc-4.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 4)
(i 0 4)
(i 1 4)
(i 2 4)
(i 3 4)
(permute-vector 4)
(i 0 4)
(i 1 4)
(i 2 4)
(i 3 4)
run:inventor/benchmarks/small/l3/trove-crc-4 20750
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-4.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 1 4 -1 localId warpSize 0 1 3))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 4 8 32 -1 i struct-size 8 -1 17))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i) (sw-xform i struct-size -1 4 4 1 localId warpSize 0 8 1))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
21
swizzle_inventor_benchmarks/small_l2_1d-conv.rkt - 0
solving...
(blockID
 (0)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
(blockID
 (1)
 (64)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)
   (32)
   (33)
   (34)
   (35)
   (36)
   (37)
   (38)
   (39)
   (40)
   (41)
   (42)
   (43)
   (44)
   (45)
   (46)
   (47)
   (48)
   (49)
   (50)
   (51)
   (52)
   (53)
   (54)
   (55)
   (56)
   (57)
   (58)
   (59)
   (60)
   (61)
   (62)
   (63)))
run:inventor/benchmarks/small/l2/1d-conv 10754
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l2_1d-conv.rkt:91:0
'(define (conv1d-sketch threadId blockID blockDim I O W I-sizes O-sizes)
   (define I-cached (create-matrix-local (x-y-z 2)))
   (define gid (+ (* blockID blockDim) threadId))
   (define localId (get-idInWarp threadId))
   (define offset (- gid localId))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (+ warpSize 2))
    #f
    #:round
    2)
   (define o (create-accumulator (list * +) identity blockDim))
   (for/bounded
    ((i 3))
    (let* ((index (ite (> localId (+ -1 (@dup i))) (@dup 0) (@dup 1)))
           (lane
            (sw-xform
             localId
             warpSize
             1
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (w-idx
            (sw-xform
             localId
             warpSize
             0
             warpSize
             warpSize
             1
             i
             warpSize
             1
             warpSize
             0))
           (x (shfl (get I-cached index) lane))
           (w (get W w-idx)))
      (accumulate
       o
       (list w x)
       #:pred
       (>= (choose localId) (- -1 (choose localId))))))
   (reg-to-global o O gid))
10
swizzle_inventor_benchmarks/small_l3_2d-stencil-3.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/small/l3/2d-stencil-3 50882
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_2d-stencil-3.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 3) (kx 3))
    (let* ((index-j (ite (<= ky (+ 0 warp-row)) (@dup 0) (@dup 1)))
           (index-i (ite (> kx (- 1 warp-col)) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 4 4 1 kx 3 -1 -3 2))
           (lane-y (sw-xform warp-row H 0 1 4 -1 ky 3 1 3 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
51
swizzle_inventor_benchmarks/small_l1_trove-rcr-7.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 7)
(i 0 7)
(i 1 7)
(i 2 7)
(i 3 7)
(i 4 7)
(i 5 7)
(i 6 7)
run:inventor/benchmarks/small/l1/trove-rcr-7 20083
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-rcr-7.rkt:76:0
'(define (AOS-load-rcr-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       -1
       warpSize
       warpSize
       1
       i
       struct-size
       0
       struct-size
       31)))
   (define O-cached
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         2
         struct-size
         struct-size
         1
         localId
         warpSize
         2
         warpSize
         1))))
   (local-to-global
    O-cached
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       9
       warpSize
       warpSize
       1
       i
       struct-size
       9
       struct-size
       9))))
(cost 0)
24
swizzle_inventor_benchmarks/small_l1_2d-stencil-3.rkt - 0
solving...
(warpSize 16)
(blockID
 (0 0)
 (16 1)
 #((0 0)
   (1 0)
   (2 0)
   (3 0)
   (4 0)
   (5 0)
   (6 0)
   (7 0)
   (8 0)
   (9 0)
   (10 0)
   (11 0)
   (12 0)
   (13 0)
   (14 0)
   (15 0)))
run:inventor/benchmarks/small/l1/2d-stencil-3 21119
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_2d-stencil-3.rkt:106:0
'(define (stencil-2d-sketch threadId blockID blockDim I O I-sizes O-sizes)
   (define gid (+ (* blockID blockDim) threadId))
   (define gx (get-x gid))
   (define gy (get-y gid))
   (define id (modulo (get-x threadId) warpSize))
   (define warp-col (modulo id W))
   (define warp-row (quotient id W))
   (define offset-x (* (quotient gx warpSize) W))
   (define offset-y (* gy H))
   (define I-cached (create-matrix-local (x-y-z 2 2)))
   (global-to-local
    I
    I-cached
    (x-y-z 1 1)
    (lov2vol (x-y-z offset-x offset-y))
    (+ warp-shape 2)
    #f
    #:warp-shape
    warp-shape
    #:round
    (x-y-z 2 2))
   (define o (create-accumulator (list +) /9 blockDim))
   (for*
    ((ky 3) (kx 3))
    (let* ((index-j (ite (>= warp-row ky) (@dup 0) (@dup 1)))
           (index-i (ite (<= kx warp-col) (@dup 0) (@dup 1)))
           (lane-x (sw-xform warp-col W 1 W W 1 kx 3 1 3 0))
           (lane-y (sw-xform warp-row H 1 H H 1 ky 3 1 3 0))
           (lane (+ (* lane-y W) lane-x))
           (x (shfl (get I-cached index-i index-j) lane)))
      (accumulate o x)))
   (reg-to-global
    (accumulate-final o)
    O
    (lov2vol (x-y-z (+ offset-x warp-col) (+ offset-y warp-row)))))
21
swizzle_inventor_benchmarks/small_l1_trove-crc-7.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 7)
(i 0 7)
(i 1 7)
(i 2 7)
(i 3 7)
(i 4 7)
(i 5 7)
(i 6 7)
(permute-vector 7)
(i 0 7)
(i 1 7)
(i 2 7)
(i 3 7)
(i 4 7)
(i 5 7)
(i 6 7)
run:inventor/benchmarks/small/l1/trove-crc-7 11043
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-crc-7.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         2
         struct-size
         struct-size
         1
         localId
         warpSize
         5
         warpSize
         0))))
   (for
    ((i struct-size))
    (let* ((lane
            (sw-xform
             localId
             warpSize
             7
             warpSize
             warpSize
             1
             i
             struct-size
             1
             struct-size
             0))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         1
         struct-size
         struct-size
         1
         localId
         warpSize
         0
         warpSize
         0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
12
swizzle_inventor_benchmarks/small_l3_trove-crc-2.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 2)
(i 0 2)
(i 1 2)
(permute-vector 2)
(i 0 2)
(i 1 2)
run:inventor/benchmarks/small/l3/trove-crc-2 8767
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l3_trove-crc-2.rkt:76:0
'(define (AOS-load-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define O-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size)
   (define I-cached2
     (permute-vector
      I-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 -1 2 -1 localId warpSize 0 -1 0))))
   (for
    ((i struct-size))
    (let* ((lane (sw-xform localId warpSize 2 16 32 -1 i struct-size -1 -2 18))
           (x (shfl (get I-cached2 (@dup i)) lane)))
      (set O-cached (@dup i) x)))
   (define O-cached2
     (permute-vector
      O-cached
      struct-size
      (lambda (i) (sw-xform i struct-size 0 1 2 -1 localId warpSize 0 16 0))))
   (local-to-global
    O-cached2
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size))
(cost 0)
9
swizzle_inventor_benchmarks/small_l1_trove-rcr-3.rkt - 0
solving...
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(blockID
 (0)
 (32)
 #((0)
   (1)
   (2)
   (3)
   (4)
   (5)
   (6)
   (7)
   (8)
   (9)
   (10)
   (11)
   (12)
   (13)
   (14)
   (15)
   (16)
   (17)
   (18)
   (19)
   (20)
   (21)
   (22)
   (23)
   (24)
   (25)
   (26)
   (27)
   (28)
   (29)
   (30)
   (31)))
(permute-vector 3)
(i 0 3)
(i 1 3)
(i 2 3)
run:inventor/benchmarks/small/l1/trove-rcr-3 5721
/home/krzysd/enumerative-search/swizzleflow/swizzle_inventor_benchmarks/small_l1_trove-rcr-3.rkt:76:0
'(define (AOS-load-rcr-sketch threadId blockID blockDim I O a b c)
   (define I-cached (create-matrix-local (x-y-z struct-size)))
   (define localId (modulo (get-x threadId) 32))
   (define offset
     (* struct-size (- (+ (* blockID blockDim) (get-x threadId)) localId)))
   (global-to-local
    I
    I-cached
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       1
       warpSize
       warpSize
       1
       i
       struct-size
       0
       struct-size
       0)))
   (define O-cached
     (permute-vector
      I-cached
      struct-size
      (lambda (i)
        (sw-xform
         i
         struct-size
         -1
         struct-size
         struct-size
         1
         localId
         warpSize
         1
         warpSize
         0))))
   (local-to-global
    O-cached
    O
    (x-y-z 1)
    offset
    (x-y-z (* warpSize struct-size))
    #f
    #:round
    struct-size
    #:shfl
    (lambda (localId i)
      (sw-xform
       localId
       warpSize
       11
       warpSize
       warpSize
       1
       i
       struct-size
       21
       struct-size
       0))))
(cost 0)
7
